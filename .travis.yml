language: java
jdk:
- oraclejdk8
cache:
  directories:
  - "$HOME/.m2"
sudo: required
services:
- docker
notifications:
  email:
  - jhh@easedot.com
  on_success: always
  on_failure: always
branches:
  only:
  - master
env:
  global:
  - secure: Yu1x62tSrVAXeL8SO0KNVeyHZlKyJ3zjqhVRKwlrK1rZCy3peyh3LEbKX/eo9mSwLSq3N6NMsv2EI85NNGZaqWJX3rzi7PZznoV53C28fbn0/35F/dWtPJwd4qtHd/lxtCwIPJi/DcUiEM4Cd+wg1hV7aObQPBmN8uQPTx09BbfO2HV5OgB2H4hQW5XCXDHY2BuIOuJvjCEEOa3RlybA+4NlHmASap+IOA1efDHdxQ483h7Mu1D27sdw/xwoy1kANpiVEJGfza74KXInYrGlVN1y8CCJ943hgWET1YAOnrvwQn8aT7rCaJGHHp7GSpbswUQ3T2oEp4rAGxt+CkhcfLCOBiQnxNj4RsKHV1IZPFxsbvstXY4KRNeeoSAX6VfzmzGvpWh1ia1/ttslQpZ9fPCuhiFWtizykYnBGoKkpPGCZiREV5Hu46JAL07aBeVpK4N1j9zdywVWJmceAjnm1LB01iUcG0eGEhdkRkBL1NqLwyVgLW/uul3qQ5vziaWW8kmD2EAXwsB3pFtNJWLvcrR3Ph8CQo4r3ESZUcFx3XJ2KCmXwKoUMN6j1qUhtUg6nf0VqcdjOExD0sroR1oFCa5SVqx/UVLoQhePhYjjpMUSbSMOqrB8a85sRC1T1ldquUkIdbOtR2fhk9w4GwGcs6f74zC6PHKHXz6SNB4S1VU=
  - secure: WM2j+bC5LmK5lsnj5FcI9FHZBGVPK+sJS3pVi1Mv5wnvbV9KUhp6C4gwmRDzeI1+/Wd5LSCPEyWX8PcQp/R+88iwoz5bOFfJRIqtgU4jQ4pAOjha7NhkNBOi9sd+TdH6U35E5QdvyN4bS0945YEi/p1a1gjyD/k3kDyiC9Mp/i+ADhGxg5s/rtg++Z3h6VrWstkF7/zKPtabHQBMLLJ9glXmWFrpVoLAl8efVCoXg/RvfdJ2fbJv/vLLIIBkOJkR/qwYik7waIUkIQuDU+TCAJSgnsNF/FAjzUQ38CTEDvCptmtLNvMh+Nf7klZ6CYwL2AwZnYoJkDN1mlD71PxBrvTX2TrIKoUmke0BgaiZikxE31oI1jFMY9BGeLK57K+Lp8vdcrUffZoGW1pvAz9OrmTobGhlO10UQTes1b3UPoL/sWgtHHXFEAqw3vvUozhtdm3pM1OK07DvqAZQgfaTYIRXIOAb8lKq4F/ZnUxodZJb1EUwjL+kvLeweIxM8+gGRNJ0upxbGdG0hQIQAHhqOTN4NhHdulC5TH8SXYG8PLtoO05uvbynvNBpYCet3FdNhewqGiV+vRwLHe7sIPCIeDYO5yxmKFOG7h9snlV/r953yZhiZWm2Q9t711psb0n5ULHSw5LahzZ8+MLTxRp9gvUuWLwLZEuFmD73WhVWY8Q=
  - secure: asDO1KZRXjdNhxfSsV0JteJBKI2D85EJlaxWCMZqps4zi/2l4bWNiQKscKhrvRZw8oE3m64AcnK/iXOHStJIR/M63Sb5Aci9R5YFSGKLYDl7xMMcyVSKA5rx4QA0z1+E7E84OFnJA/smuigtjT5KdJuGzMTJxnj1TbXQSLAkJy1GXxojU/2yCkGxxoNXYf+kkmUvduG2EeMFeWoQHN9bg6vXDLEid7HcLQMi7O/SpXkAH0ksYrVKblMNBE1zuVhgA7FPG2IGeNKoBnd5M7oqTT41NSRRAiPBi8UT5HcxcynCzPrbacwDFGmy3+oCDMw9sL8aogypooQ194Pq1vvdSUmjnH7d3STf3DVxoCSVwaXLyyWoH4fribYX+0O5tc3yEpe8R5GnqX3DnGh2DfrhEDY00EL38uJl6ps+WPF5KafYDIZUl8KlvUEfq9ZAl8l3Lgq8/2G9A8zrDYBUES9pxtwF3vKp4e0o23qqZ8GKQKJyZlQ7DAkStPmRB+CI//FYvJIMWrOi3WLJTcx8mX9zkjp2G2HF1GY25Fb74mP5q/Om4KillPGEp2/VUTZ5uad35HmIkzigchfFL+gBjUub5kGZ17wRBhmDOmTjtt/DGjFVNlPi06J0th2n8eFiDXMLT4OPxrhSkVpJw32382/Pwe41AZSMxz7iUxoDBqjHZ6s=
  - secure: qh5oqtgj3oU1iHvZ+vB3cIkpsL/XyU7bjyVhfW6EO6pet4d8devihYq9TnXdwaMbRNlVMoQ/kruZI1mLCnGKbBmxYrixa7bH9UXB+S6WxdP0suNx08XF+m7yFw1ID0iNnyb9CRqwVY/VvWjuivkGssrQqHyYFeqHReYXHz83AarhbmVTQX4OG1Mk3vqASvf9ZdH9stbA+zmWfnHJaIGiKdlk8mDIvR44jObC//XaRX7TzJ6xbB0U2iC1O6IUKNLIu+hJvNJn7CBIHK4jp/gX8yuiHqayvliik/7JDoSklcINPyDXSF+uPWzokxiPKqOOYJaYtLNul8X8LYT4wF2U1R1Md9fSpaoaqmyr9YwsDfHen4WbfM/borATX3/1GU+0cZuM1ISejdgSAdlwuV+7MmQ+GQsxsOOOwxHW5TaG4epIzUd/Tg/zjrCWy/1XIGAYgfetpZmWZqR9REaDiHcQ1alqte5ivgi93CBocVS5OjsUtVfBRH2Td2oCjaiBN+emS1iy4DFHgvJTvsulp7kx3s/DDkrACZX1tgeRm6fsugQbRM7es0vGSxa/D2wCfGfXkPNhQzfS38BVw2vCKYio7FnfNDq00u23cf5dHWWWGnkgEVTD0v2svkSqD4Fdss+5Qsol+JqsqJ+zOLBuHrGiWrCC0LVDlTrrGU77XmXFRxc=
  - secure: WaM208FMfiqM84MLk3P5IIOW7zmXxjOGLoRMdf4EmVso5sfX/J1wsiqdsHpyygTjSLtAS2IW6N7Mh/y/Bb20oS+S6QDCcdB3MFxwBP4GFtm7BgOnpwibS8KkfswGcBtLmlbsF026fhZ8n3PjSznifElPElMIqzQr7kAXmwy4BGl4pD3NlER8gthgK+PjOsUVKR68SdLZIiN7aApB0+G+HIrNbMcky2yNga7h8u2Ad3IAXPHExp7o4tMk31r0zfjzamxBRF2w/A79eIR4Cdo6bh9EUHRWN0wSUF4HpQ87ziLuTwuG+HijEjKQIbkrGk9KgIX7Vka46PrF2u3lmeXM4+Ts9Pa9Mp4q06J5pIE4R9ZqRC2olyhRsqiTserbFAdz84aHmTyF/i+N5O3LdmjOj6yMj8W2bheKgDjWNHjoPZpyQFjGmy98VX8vJcHUenRqHmR36hfTPfCyFexmt6P9uB97mFiwilxUwy3ZrND3JIfGwG+Mj55y2fOBL+K5xAOpAP40SZw5h6SHxxX/IJnmO/ER34mzRkp6cDEXbxUrSKn5UCf9FrWkM/XPZxsVqOvDponOU82K3TJXsy8S9LIUcj7P/JfWWabri/52k47S9g5HWsGlh69wGyaPrJ/itnEWg6OulfYNe/TzGkb0MZol4w0nI3dVeiS400tUB9BrOkY=
before_install:
- gem install travis -v 1.8.5 --no-document
- sudo curl -k -o /usr/local/bin/ecs-cli https://s3.amazonaws.com/amazon-ecs-cli/ecs-cli-linux-amd64-latest
- sudo chmod +x /usr/local/bin/ecs-cli
- export BUILD_NAME=chapter10-$TRAVIS_BRANCH-$(date -u "+%Y%m%d%H%M%S")-$TRAVIS_BUILD_NUMBER
- export CONTAINER_IP=34.209.148.131
- export PLATFORM_TEST_NAME="chapter10-platform-tests"
script:
- sh travis_scripts/tag_build.sh
- sh travis_scripts/build_services.sh
- sh travis_scripts/deploy_to_docker_hub.sh
- sh travis_scripts/deploy_to_amazon_ecs.sh
